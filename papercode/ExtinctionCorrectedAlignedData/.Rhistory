assign(paste0("kb_",type),kb)
assign(paste0(type,"lambda"),lambda)
p = minEM(data, lambda, type, ka, kb, tol= 1e-4,maxiter=100)
assign(paste0("p",type),p)
}
rm(list=c("lambda","ka","kb","p"))
save(pt,ps,pn,file = paste0(outpath,"Estimators.RData"))
x = seq(-10,50,0.1)
Bval = orthbasis(x,bknots)$B
par(mfrow=c(1,2))
plot(x,Bval%*%pt$theta_mu,'l',col='red',main="Mean curve of B band")
lines(x,Bval%*%ps$theta_mu,'l',col='green')
lines(x,Bval%*%pn$theta_mu,'l',col='blue')
legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1)
plot(x,Bval%*%pt$theta_nu,'l',col='red',main="Mean curve of I band")
lines(x,Bval%*%ps$theta_nu,'l',col='green')
lines(x,Bval%*%pn$theta_nu,'l',col='blue')
par(mfrow=c(2,3))
plot(x,Bval%*%pt$theta_f[,1],'l',col='red',main="PC1 of B band")
lines(x,Bval%*%ps$theta_f[,1],'l',col='green')
lines(x,Bval%*%pn$theta_f[,1],'l',col='blue')
#legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1,border=NULL)
plot(x,Bval%*%pt$theta_f[,2],'l',col='red',main="PC2 of B band")
lines(x,Bval%*%ps$theta_f[,2],'l',col='green')
lines(x,Bval%*%pn$theta_f[,2],'l',col='blue')
plot(0,type='n',axes=FALSE,ann=FALSE)
plot(x,Bval%*%pt$theta_g[,1],'l',col='red',main="PC1 of I band")
lines(x,Bval%*%ps$theta_g[,1],'l',col='green')
lines(x,Bval%*%pn$theta_g[,1],'l',col='blue')
plot(x,Bval%*%pt$theta_g[,2],'l',col='red',main="PC2 of I band")
lines(x,Bval%*%ps$theta_g[,2],'l',col='green')
lines(x,Bval%*%pn$theta_g[,2],'l',col='blue')
plot(x,Bval%*%pn$theta_g[,3],'l',col='red',main="PC3 of I band")
library(pairedfda)
load("~/Desktop/papercode2.1/astronomy.RData")
bknots <<- c(c(-0.1,-0.05),
seq(0, 1, length.out = 15),
c(1.05,1.1))
bknots = 50*bknots-5
data=predata(nobs_y = nobs_r,
nobs_z = nobs_i,
time_y = R$Phase,
time_z = II$Phase,
y = R$Mag,
z = II$Mag,
knots = bknots, order = 3)
outpath='~/Desktop/papercode2.1/real_analysis_ri/'
for(type in c('t','s','n'))
{
load(paste0(outpath,"cvtable_",type,".RData"))
res_collect=matrix(as.double(res_collect),nrow=7,ncol=16,byrow=FALSE)
ind_min = which.min(res_collect[7,])
lambda=res_collect[3:6,ind_min]
ka = res_collect[1,ind_min]
kb = res_collect[2,ind_min]
assign(paste0("ka_",type),ka)
assign(paste0("kb_",type),kb)
assign(paste0(type,"lambda"),lambda)
p = minEM(data, lambda, type, ka, kb, tol= 1e-4,maxiter=100)
assign(paste0("p",type),p)
}
rm(list=c("lambda","ka","kb","p"))
save(pt,ps,pn,file = paste0(outpath,"Estimators.RData"))
x = seq(-10,50,0.1)
Bval = orthbasis(x,bknots)$B
par(mfrow=c(1,2))
plot(x,Bval%*%pt$theta_mu,'l',col='red',main="Mean curve of B band")
lines(x,Bval%*%ps$theta_mu,'l',col='green')
lines(x,Bval%*%pn$theta_mu,'l',col='blue')
legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1)
plot(x,Bval%*%pt$theta_nu,'l',col='red',main="Mean curve of I band")
lines(x,Bval%*%ps$theta_nu,'l',col='green')
lines(x,Bval%*%pn$theta_nu,'l',col='blue')
par(mfrow=c(2,3))
plot(x,Bval%*%pt$theta_f[,1],'l',col='red',main="PC1 of B band")
lines(x,Bval%*%ps$theta_f[,1],'l',col='green')
lines(x,Bval%*%pn$theta_f[,1],'l',col='blue')
#legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1,border=NULL)
plot(x,Bval%*%pt$theta_f[,2],'l',col='red',main="PC2 of B band")
lines(x,Bval%*%ps$theta_f[,2],'l',col='green')
lines(x,Bval%*%pn$theta_f[,2],'l',col='blue')
#plot(0,type='n',axes=FALSE,ann=FALSE)
plot(x,Bval%*%pt$theta_f[,3],'l',col='red',main="PC2 of B band")
library(pairedfda)
load("~/Desktop/papercode2.1/astronomy.RData")
bknots <<- c(c(-0.1,-0.05),
seq(0, 1, length.out = 15),
c(1.05,1.1))
bknots = 50*bknots-5
data=predata(nobs_y = nobs_r,
nobs_z = nobs_i,
time_y = R$Phase,
time_z = II$Phase,
y = R$Mag,
z = II$Mag,
knots = bknots, order = 3)
outpath='~/Desktop/papercode2.1/real_analysis_ri/'
for(type in c('t','s','n'))
{
load(paste0(outpath,"cvtable_",type,".RData"))
res_collect=matrix(as.double(res_collect),nrow=7,ncol=16,byrow=FALSE)
ind_min = which.min(res_collect[7,])
#lambda=res_collect[3:6,ind_min]
#ka = res_collect[1,ind_min]
#kb = res_collect[2,ind_min]
lambda=c(0,0,0,0)
ka=3
kb=3
assign(paste0("ka_",type),ka)
assign(paste0("kb_",type),kb)
assign(paste0(type,"lambda"),lambda)
p = minEM(data, lambda, type, ka, kb, tol= 1e-4,maxiter=100)
assign(paste0("p",type),p)
}
rm(list=c("lambda","ka","kb","p"))
save(pt,ps,pn,file = paste0(outpath,"Estimators.RData"))
x = seq(-10,50,0.1)
Bval = orthbasis(x,bknots)$B
par(mfrow=c(1,2))
plot(x,Bval%*%pt$theta_mu,'l',col='red',main="Mean curve of B band")
lines(x,Bval%*%ps$theta_mu,'l',col='green')
lines(x,Bval%*%pn$theta_mu,'l',col='blue')
legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1)
plot(x,Bval%*%pt$theta_nu,'l',col='red',main="Mean curve of I band")
lines(x,Bval%*%ps$theta_nu,'l',col='green')
lines(x,Bval%*%pn$theta_nu,'l',col='blue')
par(mfrow=c(2,3))
plot(x,Bval%*%pt$theta_f[,1],'l',col='red',main="PC1 of B band")
lines(x,Bval%*%ps$theta_f[,1],'l',col='green')
lines(x,Bval%*%pn$theta_f[,1],'l',col='blue')
#legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1,border=NULL)
plot(x,Bval%*%pt$theta_f[,2],'l',col='red',main="PC2 of B band")
lines(x,Bval%*%ps$theta_f[,2],'l',col='green')
lines(x,Bval%*%pn$theta_f[,2],'l',col='blue')
#plot(0,type='n',axes=FALSE,ann=FALSE)
plot(x,Bval%*%pt$theta_f[,3],'l',col='red',main="PC2 of B band")
lines(x,Bval%*%ps$theta_f[,3],'l',col='green')
lines(x,Bval%*%pn$theta_f[,3],'l',col='blue')
plot(x,Bval%*%pt$theta_g[,1],'l',col='red',main="PC1 of I band")
lines(x,Bval%*%ps$theta_g[,1],'l',col='green')
lines(x,Bval%*%pn$theta_g[,1],'l',col='blue')
plot(x,Bval%*%pt$theta_g[,2],'l',col='red',main="PC2 of I band")
lines(x,Bval%*%ps$theta_g[,2],'l',col='green')
lines(x,Bval%*%pn$theta_g[,2],'l',col='blue')
plot(x,Bval%*%pn$theta_g[,3],'l',col='blue',main="PC3 of I band")
lines(x,Bval%*%ps$theta_g[,2],'l',col='green')
lines(x,Bval%*%pt$theta_g[,2],'l',col='red')
library(pairedfda)
load("~/Desktop/papercode2.1/astronomy.RData")
bknots <<- c(c(-0.1,-0.05),
seq(0, 1, length.out = 15),
c(1.05,1.1))
bknots = 50*bknots-5
data=predata(nobs_y = nobs_r,
nobs_z = nobs_i,
time_y = R$Phase,
time_z = II$Phase,
y = R$Mag,
z = II$Mag,
knots = bknots, order = 3)
outpath='~/Desktop/papercode2.1/real_analysis_ri/'
for(type in c('t','s','n'))
{
load(paste0(outpath,"cvtable_",type,".RData"))
res_collect=matrix(as.double(res_collect),nrow=7,ncol=16,byrow=FALSE)
ind_min = which.min(res_collect[7,])
#lambda=res_collect[3:6,ind_min]
#ka = res_collect[1,ind_min]
#kb = res_collect[2,ind_min]
lambda=c(0,0,0,0)
ka=2
kb=3
assign(paste0("ka_",type),ka)
assign(paste0("kb_",type),kb)
assign(paste0(type,"lambda"),lambda)
p = minEM(data, lambda, type, ka, kb, tol= 1e-4,maxiter=100)
assign(paste0("p",type),p)
}
rm(list=c("lambda","ka","kb","p"))
save(pt,ps,pn,file = paste0(outpath,"Estimators.RData"))
x = seq(-10,50,0.1)
Bval = orthbasis(x,bknots)$B
par(mfrow=c(1,2))
plot(x,Bval%*%pt$theta_mu,'l',col='red',main="Mean curve of B band")
lines(x,Bval%*%ps$theta_mu,'l',col='green')
lines(x,Bval%*%pn$theta_mu,'l',col='blue')
legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1)
plot(x,Bval%*%pt$theta_nu,'l',col='red',main="Mean curve of I band")
lines(x,Bval%*%ps$theta_nu,'l',col='green')
lines(x,Bval%*%pn$theta_nu,'l',col='blue')
par(mfrow=c(2,3))
plot(x,Bval%*%pt$theta_f[,1],'l',col='red',main="PC1 of B band")
lines(x,Bval%*%ps$theta_f[,1],'l',col='green')
lines(x,Bval%*%pn$theta_f[,1],'l',col='blue')
#legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1,border=NULL)
plot(x,Bval%*%pt$theta_f[,2],'l',col='red',main="PC2 of B band")
lines(x,Bval%*%ps$theta_f[,2],'l',col='green')
lines(x,Bval%*%pn$theta_f[,2],'l',col='blue')
plot(0,type='n',axes=FALSE,ann=FALSE)
plot(x,Bval%*%pt$theta_g[,1],'l',col='red',main="PC1 of I band")
lines(x,Bval%*%ps$theta_g[,1],'l',col='green')
lines(x,Bval%*%pn$theta_g[,1],'l',col='blue')
plot(x,Bval%*%pt$theta_g[,2],'l',col='red',main="PC2 of I band")
lines(x,Bval%*%ps$theta_g[,2],'l',col='green')
lines(x,Bval%*%pn$theta_g[,2],'l',col='blue')
plot(x,Bval%*%pn$theta_g[,3],'l',col='blue',main="PC3 of I band")
lines(x,Bval%*%ps$theta_g[,2],'l',col='green')
lines(x,Bval%*%pt$theta_g[,2],'l',col='red')
n = data$n
ind_y = c(0, cumsum(data$nobs_y))
ind_z = c(0, cumsum(data$nobs_z))
time_y=data$time_y
par(mfrow=c(4,4))
par(mar=c(1,1,1,1))
for(j in 1:n)
{
yt=Bval%*%pt$theta_mu+Bval%*%pt$theta_f%*%pt$alpha[j,]
ys=Bval%*%ps$theta_mu+Bval%*%ps$theta_f%*%ps$alpha[j,]
yn=Bval%*%pn$theta_mu+Bval%*%pn$theta_f%*%pn$alpha[j,]
plot(time_y[(ind_y[j]+1):ind_y[j+1]],data$y[(ind_y[j]+1):ind_y[j+1]],
cex=0.5,pch=21,main=paste("subject",j))
points(x,yt,'l',col="red")
points(x,ys,'l',col="green")
points(x,yn,'l',col="blue")
}
time_z=data$time_z
par(mfrow=c(4,4))
par(mar=c(1,1,1,1))
for(j in 1:n)
{
zt=Bval%*%pt$theta_nu+Bval%*%pt$theta_g%*%pt$beta[j,]
zs=Bval%*%ps$theta_nu+Bval%*%ps$theta_g%*%ps$beta[j,]
zn=Bval%*%pn$theta_nu+Bval%*%pn$theta_g%*%pn$beta[j,]
plot(time_z[(ind_z[j]+1):ind_z[j+1]],data$z[(ind_z[j]+1):ind_z[j+1]],
cex=0.5,pch=21,main=paste("subject",j))
points(x,zt,'l',col="red")
points(x,zs,'l',col="green")
points(x,zn,'l',col="blue")
}
### Fit goodness
res_yt=rep(0,n)
res_ys=res_yt
res_yn=res_yt
for(i in 1:n)
{
BB.tmp = data$B_y[(ind_y[i]+1):ind_y[i+1],]
yt=BB.tmp%*%pt$theta_mu+BB.tmp%*%pt$theta_f%*%pt$alpha[i,]
ys=BB.tmp%*%ps$theta_mu+BB.tmp%*%ps$theta_f%*%ps$alpha[i,]
yn=BB.tmp%*%pn$theta_mu+BB.tmp%*%pn$theta_f%*%pn$alpha[i,]
y_part = data$y[(ind_y[i]+1):ind_y[i+1]]
res_yt[i] = mean((yt-y_part)^2)
res_ys[i] = mean((ys-y_part)^2)
res_yn[i] = mean((yn-y_part)^2)
}
square_res_y=c(sum(res_yt**2),sum(res_ys**2),sum(res_yn**2))
res_zt=rep(0,length(data$z))
res_zs=res_yt
res_zn=res_yt
for(i in 1:n)
{
BB.tmp = data$B_z[(ind_z[i]+1):ind_z[i+1],]
zt=BB.tmp%*%pt$theta_nu+BB.tmp%*%pt$theta_g%*%pt$beta[i,]
zs=BB.tmp%*%ps$theta_nu+BB.tmp%*%ps$theta_g%*%ps$beta[i,]
zn=BB.tmp%*%pn$theta_nu+BB.tmp%*%pn$theta_g%*%pn$beta[i,]
z_part = data$z[(ind_z[i]+1):ind_z[i+1]]
res_zt[i] = mean((zt-z_part)^2)
res_zs[i] = mean((zs-z_part)^2)
res_zn[i] = mean((zn-z_part)^2)
}
square_res_z=c(sum(res_zt**2),sum(res_zs**2),sum(res_zn**2))
square_res = rbind(square_res_y,square_res_z)
colnames(square_res)=c("T","Slash","Normal")
square_res
library(pairedfda)
load("~/Desktop/papercode2.1/astronomy.RData")
bknots <<- c(c(-0.1,-0.05),
seq(0, 1, length.out = 15),
c(1.05,1.1))
bknots = 50*bknots-5
data=predata(nobs_y = nobs_r,
nobs_z = nobs_i,
time_y = R$Phase,
time_z = II$Phase,
y = R$Mag,
z = II$Mag,
knots = bknots, order = 3)
outpath='~/Desktop/papercode2.1/real_analysis_ri/'
for(type in c('t','s','n'))
{
load(paste0(outpath,"cvtable_",type,".RData"))
res_collect=matrix(as.double(res_collect),nrow=7,ncol=16,byrow=FALSE)
ind_min = which.min(res_collect[7,])
lambda=res_collect[3:6,ind_min]
ka = res_collect[1,ind_min]
kb = res_collect[2,ind_min]
assign(paste0("ka_",type),ka)
assign(paste0("kb_",type),kb)
assign(paste0(type,"lambda"),lambda)
p = minEM(data, lambda, type, ka, kb, tol= 1e-4,maxiter=100)
assign(paste0("p",type),p)
}
rm(list=c("lambda","ka","kb","p"))
save(pt,ps,pn,file = paste0(outpath,"Estimators.RData"))
ka_t
kb_t
kb_t
library(pairedfda)
load("~/Desktop/papercode2.1/astronomy.RData")
bknots <<- c(c(-0.1,-0.05),
seq(0, 1, length.out = 15),
c(1.05,1.1))
bknots = 50*bknots-5
data=predata(nobs_y = nobs_r,
nobs_z = nobs_i,
time_y = R$Phase,
time_z = II$Phase,
y = R$Mag,
z = II$Mag,
knots = bknots, order = 3)
outpath='~/Desktop/papercode2.1/real_analysis_ri/'
for(type in c('t','s','n'))
{
load(paste0(outpath,"cvtable_",type,".RData"))
res_collect=matrix(as.double(res_collect),nrow=7,ncol=16,byrow=FALSE)
ind_min = which.min(res_collect[7,])
lambda=res_collect[3:6,ind_min]
ka = res_collect[1,ind_min]
kb = res_collect[2,ind_min]
assign(paste0("ka_",type),ka)
assign(paste0("kb_",type),kb)
assign(paste0(type,"lambda"),lambda)
p = minEM(data, lambda, type, ka, kb, tol= 1e-4,maxiter=100)
assign(paste0("p",type),p)
}
rm(list=c("lambda","ka","kb","p"))
save(pt,ps,pn,file = paste0(outpath,"Estimators.RData"))
ka_t
kb_t
ka_n
kb_n
load("/Volumes/huiya/Desktop/papercode2.1/real_analysis_ri/cvtable_n.RData")
View(res_collect)
View(res_collect)
load("/Volumes/huiya/Desktop/papercode2.1/real_analysis_ri/cvtable_s.RData")
load("/Volumes/huiya/Desktop/papercode2.1/real_analysis_ri/cvtable_t.RData")
load("/Volumes/huiya/Desktop/papercode2.1/real_analysis_ri/real_analysiscvtable_n.RData")
load("/Volumes/huiya/Desktop/papercode2.1/real_analysis_ri/real_analysiscvtable_n.RData")
View(res_collect)
load("/Volumes/huiya/Desktop/papercode2.1/real_analysis_ri/real_analysiscvtable_s.RData")
View(res_collect)
load("/Volumes/huiya/Desktop/papercode2.1/real_analysis_ri/real_analysiscvtable_t.RData")
View(res_collect)
load("/Volumes/huiya/Desktop/papercode2.1/real_analysis_ri/cvtable_t.RData")
View(res_collect)
clear
library(pairedfda)
load("~/Desktop/papercode2.1/astronomy.RData")
outpath='~/Desktop/papercode2.1/real_analysis/'
bknots <<- c(c(-0.1,-0.05),
seq(0, 1, length.out = 15),
c(1.05,1.1))
bknots = 50*bknots-5
setwd("~/Desktop/papercode2.1/real_analysis_ri")
knitr::opts_chunk$set(echo = TRUE)
zt=Bval%*%pt$theta_nu+Bval%*%pt$theta_g
library(pairedfda)
load("~/Desktop/papercode2.1/astronomy.RData")
bknots <<- c(c(-0.1,-0.05),
seq(0, 1, length.out = 15),
c(1.05,1.1))
bknots = 50*bknots-5
data=predata(nobs_y = nobs_r,
nobs_z = nobs_i,
time_y = R$Phase,
time_z = II$Phase,
y = R$Mag,
z = II$Mag,
knots = bknots, order = 3)
outpath='~/Desktop/papercode2.1/real_analysis_ri/'
for(type in c('t','s','n'))
{
load(paste0(outpath,"cvtable_",type,".RData"))
res_collect=matrix(as.double(res_collect),nrow=7,ncol=16,byrow=FALSE)
ind_min = which.min(res_collect[7,])
lambda=res_collect[3:6,ind_min]
ka = res_collect[1,ind_min]
kb = res_collect[2,ind_min]
assign(paste0("ka_",type),ka)
assign(paste0("kb_",type),kb)
assign(paste0(type,"lambda"),lambda)
p = minEM(data, lambda, type, ka, kb, tol= 1e-4,maxiter=100)
assign(paste0("p",type),p)
}
rm(list=c("lambda","ka","kb","p"))
save(pt,ps,pn,file = paste0(outpath,"Estimators.RData"))
zt=Bval%*%pt$theta_nu+Bval%*%pt$theta_g
x = seq(-10,50,0.1)
Bval = orthbasis(x,bknots)$B
par(mfrow=c(1,2))
plot(x,Bval%*%pt$theta_mu,'l',col='red',main="Mean curve of R band")
lines(x,Bval%*%ps$theta_mu,'l',col='green')
lines(x,Bval%*%pn$theta_mu,'l',col='blue')
legend("topleft",c("T","Slash","Normal"),col=c("red","green","blue"),lty=1)
plot(x,Bval%*%pt$theta_nu,'l',col='red',main="Mean curve of I band")
lines(x,Bval%*%ps$theta_nu,'l',col='green')
lines(x,Bval%*%pn$theta_nu,'l',col='blue')
zt=Bval%*%pt$theta_nu+Bval%*%pt$theta_g
zt=Bval%*%pt$theta_nu+Bval%*%pt$theta_g[,1]
zs=Bval%*%ps$theta_nu+Bval%*%ps$theta_g[,1]
zn=Bval%*%pn$theta_nu+Bval%*%pn$theta_g[,1]
plot(x,zt,'l',col="red")
points(x,zs,'l',col="green")
points(x,zn,'l',col="blue")
zt_mean = Bval%*%pt$theta_nu
zs_mean = Bval%*%ps$theta_nu
zn_mean = Bval%*%pn$theta_nu
zt=Bval%*%pt$theta_nu+Bval%*%pt$theta_g[,1]
zs=Bval%*%ps$theta_nu+Bval%*%ps$theta_g[,1]
zn=Bval%*%pn$theta_nu+Bval%*%pn$theta_g[,1]
plot(x,zt_mean,'l',col="red")
points(x,zs_mean,'l',col="green")
points(x,zn_mean,'l',col="blue")
points(x,zt,'l',col="red")
points(x,zs,'l',col="green")
points(x,zn,'l',col="blue")
zt_mean = Bval%*%pt$theta_nu
zs_mean = Bval%*%ps$theta_nu
zn_mean = Bval%*%pn$theta_nu
zt=Bval%*%pt$theta_nu+Bval%*%pt$theta_g[,2]
zs=Bval%*%ps$theta_nu+Bval%*%ps$theta_g[,2]
zn=Bval%*%pn$theta_nu+Bval%*%pn$theta_g[,2]
plot(x,zt_mean,'l',col="red")
points(x,zs_mean,'l',col="green")
points(x,zn_mean,'l',col="blue")
points(x,zt,'l',col="red")
points(x,zs,'l',col="green")
points(x,zn,'l',col="blue")
library(knitr)
library(kableExtra)
load(paste0(outpath,"cvtable_s.RData"))
pc_table=matrix(as.double(res_collect[7,]),4,4,byrow = FALSE)
rownames(pc_table)=c("kb=1","kb=2","kb=3","kb=4")
colnames(pc_table)=c("ka=1","ka=2","ka=3","ka=4")
kable(pc_table,caption="SMN-Slash model")
knitr::opts_chunk$set(echo = TRUE)
load("~/Desktop/papercode2.1/astronomy.RData")
bknots <<- c(c(-0.1,-0.05),
seq(0, 1, length.out = 15),
c(1.05,1.1))
bknots = 50*bknots-5
setwd("~/Desktop/ExtinctionCorrectedAlignedData/")
library(dplyr)
filenames <- list.files(pattern = ".*.txt")
n=length(filenames)
## Initialize
nobs_b=rep(0,n)
nobs_v=rep(0,n)
nobs_r=rep(0,n)
nobs_i=rep(0,n)
i=1
file=filenames[1]
all.data <- read.table(file, header = TRUE)
all.data_cut <- all.data %>% filter(Phase>-10,Phase<50)
X <- all.data_cut %>% group_by(Band) %>% summarize(n=n())
nobs_b[i]=X$n[1]
nobs_v[i]=X$n[4]
nobs_r[i]=X$n[3]
nobs_i[i]=X$n[2]
ind = c(0,cumsum(X$n[c(1,4,3,2)]))
View()all.data_cut
View(all.data_cut)
all.data <- read.table(file, header = TRUE)
all.data_cut <- all.data %>% filter(Phase>-10,Phase<50)
all.data_cut
all.data_cut %>% group_by(Band) %>% summarize(disp=max())
all.data_cut %>% group_by(Band) %>% summarize(disp=max
)
all.data_cut %>% group_by(Band) %>% summarize(disp=max(Band))
all.data_cut %>% group_by(Band) %>% summarize(disp=max(Mag))
all.data_cut %>% group_by(Band) %>% %>%
mutate_all(funs(.- mean(.)))
all.data_cut %>% group_by(Band) %>% %>%
mutate_all(funs(Mag- mean(Mag)))
gp_num = X_group %>% summarize(n_band=max(Mag))
X_group <- all.data_cut %>% group_by(Band)
gp_num = X_group %>% summarize(n_band=max(Mag))
gp_num
gp_num$n_band
gp_num = X_group %>% summarize(n_band=max(Mag)) $ n_band
X
rep(1:3,2)
all.data_cut$Mag = all.data_cut$Mag - rep(gp_num,each=X$n)
all.data <- read.table(file, header = TRUE)
all.data_cut <- all.data %>% filter(Phase>-10,Phase<50)
X_group <- all.data_cut %>% group_by(Band)
X  <- X_group %>% summarize(n=n())
nobs_b[i]=X$n[1]
nobs_v[i]=X$n[4]
nobs_r[i]=X$n[3]
nobs_i[i]=X$n[2]
gp_num = X_group %>% summarize(n_band=max(Mag))
all.data_cut$Mag = all.data_cut$Mag - rep(gp_num,each=X$n)
rep(gp_num,each=X$n)
gp_num
all.data_cut$Mag = all.data_cut$Mag - rep(gp_num$n_band,each=X$n)
rep(gp_num$n_band,each=X$n)
X$n
26+31+33+32
X$n
26*4
rep(gp_num$n_band,X$n)
source('~/Desktop/pairedfda_astronomy/data_processing.R')
