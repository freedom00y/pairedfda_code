% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Kfold_CV.R
\name{Kf_CV}
\alias{Kf_CV}
\title{K-fold Cross-Validation}
\usage{
Kf_CV(data, lambda, K, ka, kb, type)
}
\arguments{
\item{data}{Processed data. Use predata to preprocess first.}

\item{lambda}{The penalty patameters, a vector with 4 components showing in the following order, the first mean curve \eqn{(\lambda_\mu)}, the second mean curve \eqn{(\lambda_\nu)}, the first pcs \eqn{(\lambda_f)}, the second pcs \eqn{(\lambda_g)}.}

\item{K}{Number of folds}

\item{ka}{Number of pcs for the first reponse variable (Y)}

\item{kb}{Number of pcs for the second reponse variable (Z)}

\item{type}{Model type. 'n' means normal distribution, 't' means student-t distribution, 's' means slash distribution}
}
\value{
The sum of total square error (TSE) of all folds
}
\description{
Divide the dataset into K fold. Use K-1 folds to estimate the parameters and use the left one fold to evaluate the mean square error each time.
}
\examples{
rawdata = gen_data(n=100,
                   varres=0.01, 
                   gama=2, 
                   type='t',
                   ka=2,
                   kb=2)
data = predata(nobs_y = rawdata$obs_times, 
               nobs_z = rawdata$obs_times, 
               time_y = rawdata$dataset[,2], 
               time_z = rawdata$dataset[,2], 
               y = rawdata$dataset[,3], 
               z = rawdata$dataset[,4], 
               knots = 10, 
               order=3)
lambda_nopen = c(0,0,0,0)
MSE_nopen = Kf_CV(data,lambda_nopen,K=5,ka=2,kb=2,'t')
lambda_pen = rep(0.618,4)
MSE_pen = Kf_CV(data,lambda_pen,K=5,ka=2,kb=2,'t')
}
